function modal(id,type){try{content=Element(id).cloneNode(true);title=Element(id+"_title").value;width=Element(id+"_width").value;height=Element(id+"_height").value;close_action=Element(id+"_close_action").value;create_action=Element(id+"_create_action").value;save_action=Element(id+"_save_action").value;onload_action=Element(id+"_onload_action").value}catch(e){}var objBody=document.getElementsByTagName("body").item(0);var objOverlay=document.createElement("div");objOverlay.setAttribute("id","overlay");objOverlay.style.position="absolute";objOverlay.style.top="0";objOverlay.style.left="0";objOverlay.style.zIndex="90";objOverlay.style.width="100%";var arrayPageSize=getPageSize();var arrayPageScroll=getPageScroll();objOverlay.style.height=(arrayPageSize[1]+"px");objOverlay.style.display="none";objBody.insertBefore(objOverlay,objBody.firstChild);var objLightbox=document.createElement("div");objLightbox.setAttribute("id","lightbox");objLightbox.style.position="absolute";objLightbox.style.display="none";objLightbox.style.zIndex="100";var objLightbox_height=height;var objLightbox_width=width;objLightbox.style.height=objLightbox_height+"px";objLightbox.style.width=objLightbox_width+"px";var lightboxTop=((arrayPageSize[3]-objLightbox_height)/2);var lightboxLeft=((arrayPageSize[0]-objLightbox_width)/2);objLightbox.style.top=(lightboxTop<0)?"0px":lightboxTop+"px";objLightbox.style.left=(lightboxLeft<0)?"0px":lightboxLeft+"px";objBody.insertBefore(objLightbox,objOverlay.nextSibling);var objCaption=document.createElement("div");objCaption.setAttribute("id","lightboxCaption");objCaption.innerHTML=title;objLightbox.appendChild(objCaption);var objWarning=document.createElement("div");objWarning.setAttribute("id","lightboxWarning");objWarning.style.height="21px";objLightbox.appendChild(objWarning);var objContent=document.createElement("div");objContent.setAttribute("id","lightboxContent");objContent.style.height=(objLightbox_height-65)+"px";objContent.innerHTML=content.innerHTML;objLightbox.appendChild(objContent);var objCaption=document.createElement("div");objCaption.setAttribute("id","lightboxFoot");var close_button='<input type=button value="'+get_lang("close")+'" onClick='+close_action+">";if(type=="create"){var create_save_button='<input type=button value="'+get_lang("create")+'" onClick='+create_action+">"}else{if(type=="save"){var create_save_button='<input type=button value="'+get_lang("save")+'" onClick='+save_action+">"}}objCaption.innerHTML='<table width=100% cellspacing="0" cellpadding="0"><tr><td align=left>'+close_button+"</td><td align=right>"+create_save_button+"</td></tr></table>";objLightbox.appendChild(objCaption);if(onload_action){eval(onload_action)}objOverlay.style.display="block";objLightbox.style.display=""}function close_lightbox(){var a=document.getElementsByTagName("body").item(0);var b=document.getElementById("overlay");lightbox_div=document.getElementById("lightbox");a.removeChild(b);a.removeChild(lightbox_div);return}function getPageSize(){var c,a;if(window.innerHeight&&window.scrollMaxY){c=document.body.scrollWidth;a=window.innerHeight+window.scrollMaxY}else{if(document.body.scrollHeight>document.body.offsetHeight){c=document.body.scrollWidth;a=document.body.scrollHeight}else{c=document.body.offsetWidth;a=document.body.offsetHeight}}var b,d;if(self.innerHeight){b=self.innerWidth;d=self.innerHeight}else{if(document.documentElement&&document.documentElement.clientHeight){b=document.documentElement.clientWidth;d=document.documentElement.clientHeight}else{if(document.body){b=document.body.clientWidth;d=document.body.clientHeight}}}if(a<d){pageHeight=d}else{pageHeight=a}if(c<b){pageWidth=b}else{pageWidth=c}arrayPageSize=new Array(pageWidth,pageHeight,b,d);return arrayPageSize}function getPageScroll(){var a;if(self.pageYOffset){a=self.pageYOffset}else{if(document.documentElement&&document.documentElement.scrollTop){a=document.documentElement.scrollTop}else{if(document.body){a=document.body.scrollTop}}}arrayPageScroll=new Array("",a);return arrayPageScroll}function Element(a){return document.getElementById(a)}function add_css(){var a=document.getElementsByTagName("head")[0];var b=document.createElement("link");b.type="text/css";b.rel="stylesheet";if(navigator.userAgent.toLowerCase().indexOf("msie")!=-1){b.href="./expressoAdmin1_2/js/modal/css/modal_ie.css"}else{b.href="./expressoAdmin1_2/js/modal/css/modal_fx.css"}b.media="screen";a.appendChild(b);return}function make_msg(c,b){var a='<table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="zIVQRb_'+b+'"/><td class="Ptde9b_'+b+'"/><td class="Qrjz3e_'+b+'"/></tr><tr><td class="Ptde9b_'+b+'"/><td class="m14Grb_'+b+'">'+c+'</td><td class="Ptde9b_'+b+'"/></tr><tr><td class="Gbtri_'+b+'"/><td class="Ptde9b_'+b+'"/><td class="gmNpMd_'+b+'"/></tr></tbody></table>';return a}function write_msg(g,b){try{clearTimeout(setTimeout_write_msg)}catch(f){}var a=Element("lightbox");if(a!=null){var d=Element("lightboxWarning");var c="#EEEEEE"}else{var d=Element("divStatusBar");var c="#f7f8fa"}var h=Element("em_div_write_msg");if(!h){h=document.createElement("DIV");h.id="em_div_write_msg";h.style.background=c;h.style.display="none";h.align="center";h.valign="middle"}h.innerHTML=make_msg(g,b);clean_msg();d.parentNode.insertBefore(h,d);d.style.display="none";h.style.display="";setTimeout_write_msg=setTimeout("clean_msg();",4000)}function clean_msg(){var a=Element("em_div_write_msg");if((a)&&(a.style.display!="none")){a.style.display="none";a.nextSibling.style.display=""}}if(document.all){navigator.userAgent.toLowerCase().indexOf("msie 5")!=-1?is_ie5=true:is_ie5=false;is_ie=true}add_css();