function modal(id,type){try{content=Element(id).cloneNode(!0),title=Element(id+"_title").value,width=Element(id+"_width").value,height=Element(id+"_height").value,close_action=Element(id+"_close_action").value,create_action=Element(id+"_create_action").value,save_action=Element(id+"_save_action").value,onload_action=Element(id+"_onload_action").value}catch(a){}var objBody=document.getElementsByTagName("body").item(0),objOverlay=document.createElement("div");objOverlay.setAttribute("id","overlay"),objOverlay.style.position="absolute",objOverlay.style.top="0",objOverlay.style.left="0",objOverlay.style.zIndex="90",objOverlay.style.width="100%";var arrayPageSize=getPageSize(),arrayPageScroll=getPageScroll();objOverlay.style.height=arrayPageSize[1]+"px",objOverlay.style.display="none",objBody.insertBefore(objOverlay,objBody.firstChild);var objLightbox=document.createElement("div");objLightbox.setAttribute("id","lightbox"),objLightbox.style.position="absolute",objLightbox.style.display="none",objLightbox.style.zIndex="100";var objLightbox_height=height,objLightbox_width=width;objLightbox.style.height=objLightbox_height+"px",objLightbox.style.width=objLightbox_width+"px";var lightboxTop=(arrayPageSize[3]-objLightbox_height)/2,lightboxLeft=(arrayPageSize[0]-objLightbox_width)/2;objLightbox.style.top=lightboxTop<0?"0px":lightboxTop+"px",objLightbox.style.left=lightboxLeft<0?"0px":lightboxLeft+"px",objBody.insertBefore(objLightbox,objOverlay.nextSibling);var objCaption=document.createElement("div");objCaption.setAttribute("id","lightboxCaption"),objCaption.innerHTML=title,objLightbox.appendChild(objCaption);var objWarning=document.createElement("div");objWarning.setAttribute("id","lightboxWarning"),objWarning.style.height="21px",objLightbox.appendChild(objWarning);var objContent=document.createElement("div");objContent.setAttribute("id","lightboxContent"),objContent.style.height=objLightbox_height-65+"px",objContent.innerHTML=content.innerHTML,objLightbox.appendChild(objContent);var objCaption=document.createElement("div");objCaption.setAttribute("id","lightboxFoot");var close_button='<input type=button value="'+get_lang("close")+'" onClick='+close_action+">";if("create"==type)var create_save_button='<input type=button value="'+get_lang("create")+'" onClick='+create_action+">";else if("save"==type)var create_save_button='<input type=button value="'+get_lang("save")+'" onClick='+save_action+">";objCaption.innerHTML='<table width=100% cellspacing="0" cellpadding="0"><tr><td align=left>'+close_button+"</td><td align=right>"+create_save_button+"</td></tr></table>",objLightbox.appendChild(objCaption),onload_action&&eval(onload_action),objOverlay.style.display="block",objLightbox.style.display=""}function close_lightbox(){$("#overlay").remove(),$("#lightbox").remove()}function getPageSize(){var a,b;window.innerHeight&&window.scrollMaxY?(a=document.body.scrollWidth,b=window.innerHeight+window.scrollMaxY):document.body.scrollHeight>document.body.offsetHeight?(a=document.body.scrollWidth,b=document.body.scrollHeight):(a=document.body.offsetWidth,b=document.body.offsetHeight);var c,d;return self.innerHeight?(c=self.innerWidth,d=self.innerHeight):document.documentElement&&document.documentElement.clientHeight?(c=document.documentElement.clientWidth,d=document.documentElement.clientHeight):document.body&&(c=document.body.clientWidth,d=document.body.clientHeight),b<d?pageHeight=d:pageHeight=b,a<c?pageWidth=c:pageWidth=a,arrayPageSize=new Array(pageWidth,pageHeight,c,d),arrayPageSize}function getPageScroll(){var a;return self.pageYOffset?a=self.pageYOffset:document.documentElement&&document.documentElement.scrollTop?a=document.documentElement.scrollTop:document.body&&(a=document.body.scrollTop),arrayPageScroll=new Array("",a),arrayPageScroll}function Element(a){return document.getElementById(a)}function add_css(){var a=document.getElementsByTagName("head")[0],b=document.createElement("link");b.type="text/css",b.rel="stylesheet",navigator.userAgent.toLowerCase().indexOf("msie")!=-1?b.href="./expressoAdmin1_2/js/modal/css/modal_ie.css":b.href="./expressoAdmin1_2/js/modal/css/modal_fx.css",b.media="screen",a.appendChild(b)}function make_msg(a,b){var c='<table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="zIVQRb_'+b+'"/><td class="Ptde9b_'+b+'"/><td class="Qrjz3e_'+b+'"/></tr><tr><td class="Ptde9b_'+b+'"/><td class="m14Grb_'+b+'">'+a+'</td><td class="Ptde9b_'+b+'"/></tr><tr><td class="Gbtri_'+b+'"/><td class="Ptde9b_'+b+'"/><td class="gmNpMd_'+b+'"/></tr></tbody></table>';return c}function write_msg(a,b){try{clearTimeout(setTimeout_write_msg)}catch(a){}var c=Element("lightbox");if(null!=c)var d=Element("lightboxWarning"),e="#EEEEEE";else var d=Element("divStatusBar"),e="#f7f8fa";var f=Element("em_div_write_msg");f||(f=document.createElement("DIV"),f.id="em_div_write_msg",f.style.background=e,f.style.display="none",f.align="center",f.valign="middle"),f.innerHTML=make_msg(a,b),clean_msg(),d.parentNode.insertBefore(f,d),d.style.display="none",f.style.display="",setTimeout_write_msg=setTimeout("clean_msg();",4e3)}function clean_msg(){var a=Element("em_div_write_msg");a&&"none"!=a.style.display&&(a.style.display="none",a.nextSibling.style.display="")}document.all&&(navigator.userAgent.toLowerCase().indexOf("msie 5")!=-1?is_ie5=!0:is_ie5=!1,is_ie=!0),add_css();